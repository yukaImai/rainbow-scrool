
;(function($){jQuery(document).ready(function(){prlx_scr();});jQuery(window).scroll(function(){prlx_scr();});jQuery(window).resize(function(){prlx_scr();});function prlx_scr(){var scrled_Y=jQuery(window).scrollTop();var window_H=document.documentElement.clientHeight;var urlRegex=/.*url\(['"]*(.*?)['"]*\).*/g;jQuery('.vk-prlx').each(function(i){var url=jQuery(this).css('background-image').replace(urlRegex,'$1');var img=new Image();img.src=url;var img_W=img.width;var img_H=img.height;var img_rate=img_W/img_H;var area_W=jQuery(this).outerWidth();var area_H=jQuery(this).outerHeight();var area_rate=area_W/area_H;var bg_W=0;var bg_H=0;var scrl_rate=-1;if(0<scrl_rate){var need_H=area_H+(area_H*scrl_rate);}else{var need_H=area_H+(area_H*-scrl_rate);}
if(need_H<img_H){bg_H=img_H;bg_W=img_H*img_rate;}else{bg_H=need_H;bg_W=need_H*img_rate;}
if(bg_W<area_W){bg_W=area_W;bg_H=area_W/img_rate;}
var posi_Y=jQuery(this).offset().top;var prlx_start_Y=posi_Y-window_H;var bg_over_H=bg_H-area_H;var prlx_area_H=window_H+area_H;var bg_need_over_H=bg_H-need_H;var bg_offset_distance=(need_H-area_H)/prlx_area_H;if(prlx_start_Y<scrled_Y){var prlx_scrled_Y=(scrled_Y-prlx_start_Y);var bg_posi_Y=prlx_scrled_Y*bg_offset_distance;if(need_H<bg_H){var over_offset_H=bg_need_over_H/2;}else{var over_offset_H=0;}
if(0<scrl_rate){bg_posi_Y=-bg_posi_Y;bg_posi_Y=bg_posi_Y-over_offset_H;}else if(0>scrl_rate){var bottom_offset=-(need_H-area_H);bg_posi_Y=bottom_offset+bg_posi_Y;bg_posi_Y=bg_posi_Y-over_offset_H;}
var backgroundPosition="center "+bg_posi_Y+"px";}
jQuery(this).css({"background-position":backgroundPosition,"background-size":bg_W+'px '+bg_H+'px',});});}})(jQuery);